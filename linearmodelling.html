<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Linear modelling</title>

<script src="site_libs/header-attrs-2.3/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">JOAN WERU</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-pie-chart"></span>
     
    Data Visualization
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="happiness20.html">Happiness report,2020</a>
    </li>
    <li>
      <a href="tidy-black.html">Notable African American achievements throughout the years</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-cogs"></span>
     
    Machine Learning
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="advertising.html">Predicting Sales using advertising budgets</a>
    </li>
    <li>
      <a href="linearmodelling.html">Linear regression modelling</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="cv.html">
    <span class="fa fa-file-pdf-o"></span>
     
    CV
  </a>
</li>
<li>
  <a href="https://github.com/joanweru">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
<li>
  <a href="https://rpubs.com/joanweru">
    <span class="fa fa-bar-chart"></span>
     
    Rpubs
  </a>
</li>
<li>
  <a href="mailto:joanweru77@gmail.com">
    <span class="fa fa-envelope-o"></span>
     
    Contact me
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Linear modelling</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#simple-linear-regression"><span class="toc-section-number">1</span> Simple linear regression</a>
<ul>
<li><a href="#simple-linear-problems"><span class="toc-section-number">1.1</span> Simple linear problems</a></li>
</ul></li>
<li><a href="#multiple-linear-regression"><span class="toc-section-number">2</span> Multiple linear regression</a>
<ul>
<li><a href="#multiple-linear-problems"><span class="toc-section-number">2.1</span> Multiple linear problems</a></li>
</ul></li>
<li><a href="#multiple-linear-regression-with-qualitative-and-quantitative-predictor-variables."><span class="toc-section-number">3</span> Multiple linear regression with qualitative and quantitative predictor variables.</a>
<ul>
<li><a href="#multiple-linear-regression-with-one-dummyqualitative-and-one-quantitative-predictor-variable-problems"><span class="toc-section-number">3.1</span> Multiple linear regression with one dummy/qualitative and one quantitative predictor variable problems</a></li>
</ul></li>
</ul>
</div>

<p>Linear regression is one of the most common types of <strong>machine learning methods</strong>. It is a supervised learning algorithm used to predict a continuous dependent variable (<span class="math inline">\(Y\)</span>) based on the value of one or more independent variables (<span class="math inline">\(X_i\)</span>) which can be continuous or discrete. It attempts to model the relationship between the variables by fitting a linear equation to the observed data.</p>
<p>A linear regression model usually takes the form: </p>
<ul>
<li>data = response variable</li>
<li>pattern = set of particular variables</li>
<li>residual = error or noise</li>
</ul>
<div id="simple-linear-regression" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Simple linear regression</h1>
<p>For <strong>linear regression models</strong> with one <strong>quantitative predictor</strong></p>
<p><span class="math display">\[y=\beta_0+\beta_1X+\epsilon\]</span> where:</p>
<ul>
<li>x- predictor variable</li>
<li>y- response variable</li>
<li><span class="math inline">\(\beta_0\)</span>- constant/ intercept</li>
<li><span class="math inline">\(\beta_1\)</span>- <span class="math inline">\(x\)</span>’s slope or co-efficient</li>
<li><span class="math inline">\(\epsilon\)</span>-error</li>
</ul>
<div id="simple-linear-problems" class="section level2" number="1.1">
<h2 number="1.1"><span class="header-section-number">1.1</span> Simple linear problems</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(knitr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(caTools)</span></code></pre></div>
<p><font size="5"> The following are the scores that 12 students obtained on the midterm and final examination in a course in statistics. </font></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>midterm&lt;-<span class="kw">read_csv</span>(<span class="st">&quot;midterm.csv&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">midterm</th>
<th align="right">final</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">71</td>
<td align="right">83</td>
</tr>
<tr class="even">
<td align="right">49</td>
<td align="right">62</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">76</td>
</tr>
<tr class="even">
<td align="right">82</td>
<td align="right">78</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">89</td>
</tr>
<tr class="even">
<td align="right">87</td>
<td align="right">73</td>
</tr>
<tr class="odd">
<td align="right">64</td>
<td align="right">76</td>
</tr>
<tr class="even">
<td align="right">93</td>
<td align="right">89</td>
</tr>
<tr class="odd">
<td align="right">73</td>
<td align="right">77</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">51</td>
</tr>
<tr class="odd">
<td align="right">85</td>
<td align="right">74</td>
</tr>
<tr class="even">
<td align="right">58</td>
<td align="right">48</td>
</tr>
</tbody>
</table>
<blockquote>
<p><font size="4"> Fit a linear regression to the data. </font></p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">attach</span>(midterm)</span>
<span id="cb3-2"><a href="#cb3-2"></a>model&lt;-<span class="kw">lm</span>(final<span class="op">~</span>midterm,<span class="dt">data=</span>midterm)</span>
<span id="cb3-3"><a href="#cb3-3"></a>model<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>(Intercept)     midterm 
 31.6094612   0.5816001 </code></pre>
<p>Therefore <span class="math inline">\(\widehat{final}=31.6095+0.5816midterm\)</span> is the best fit that would predict a students <code>final</code> exam based on his/her <code>midterm</code> exam score</p>
<blockquote>
<p><font size="4"> Interpret the regression parameters </font></p>
</blockquote>
<p>For every additional mark in the <code>midterm</code> exam score, a students <code>final</code> exam score increases by 0.5816 points.</p>
<blockquote>
<p><font size="4"> Test for the significance of model fit </font></p>
</blockquote>
<p>we test the hypothesis</p>
<p><span class="math inline">\(H_0:\)</span> Regression fit is not significant</p>
<p><span class="math inline">\(H_1:\)</span> Regression fit is significant</p>
<p>using the f-statistic</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>sum_model=<span class="kw">summary</span>(model)</span>
<span id="cb5-2"><a href="#cb5-2"></a>sum_model<span class="op">$</span>fstatistic</span></code></pre></div>
<pre><code>   value    numdf    dendf 
15.82578  1.00000 10.00000 </code></pre>
<p>The F-statistic is 15.83 and the critical value from the f-distribution table is 4.96. The f-statistic is greater than the critical value. Therefore we reject <span class="math inline">\(H_0\)</span> and conclude that the model is indeed significant.</p>
<blockquote>
<p><font size="4"> How much of the variation is accounted for by the predictor. </font></p>
</blockquote>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>sum_model<span class="op">$</span>r.squared<span class="op">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>[1] 61.279</code></pre>
<p>From the summary 61.28% of the variation in the <code>final</code> exam score is accounted for by the <code>midterm</code> exam score.</p>
<blockquote>
<p><font size="4"> What is the correlation between midterm exam scores and final exam scores. <font size="4"></p>
</blockquote>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">cor</span>(final,midterm)</span></code></pre></div>
<pre><code>      midterm final
[1,] 0.782809     1</code></pre>
<p>The correlation is 0.7828. This indicates a strong relationship between <code>midterm</code> scores and <code>final</code> scores.</p>
<p><strong>NB: Correlation explains the strength of the relationship between an independent and dependent variable. R-squared explains to what extent the variability of one variable explains the variability of the second variable, therefore showing if the predictor variable is significant in predicting the response variable</strong></p>
<blockquote>
<p><font size="4"> Predict the final exam score for a student who scored 84 marks in the midterm exam </font></p>
</blockquote>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">predict</span>(model,<span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">midterm=</span><span class="dv">84</span>))</span></code></pre></div>
<pre><code>       1 
80.46387 </code></pre>
<blockquote>
<p><font size="4"> Find the 95% confidence interval for condition mean of final exam score obtained by students who obtained 80 marks in the midterm exam. </font></p>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">predict</span>(model,<span class="dt">interval=</span><span class="st">&quot;confidence&quot;</span>,<span class="dt">se.fit=</span>T,<span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">midterm=</span><span class="dv">80</span>))</span></code></pre></div>
<pre><code>$fit
       fit      lwr      upr
1 78.13747 71.91261 84.36233

$se.fit
[1] 2.79375

$df
[1] 10

$residual.scale
[1] 8.581803</code></pre>
<p>The 95% C.I becomes [71.913,84.362]</p>
<blockquote>
<p><font size="4"> Find the 95% prediction interval for the final exam score obtained by students who obtained 80 marks in the midterm exam. </font></p>
</blockquote>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">predict</span>(model,<span class="dt">interval =</span><span class="st">&quot;prediction&quot;</span>,<span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">midterm=</span><span class="dv">80</span>))</span></code></pre></div>
<pre><code>       fit     lwr      upr
1 78.13747 58.0283 98.24664</code></pre>
<p>The 95% P.I becomes [58.028,98.247]</p>
<p>NB: When we create <strong>confidence intervals</strong> for <strong>parameters</strong>, but when we’re predicting a single value, its not a parameter. So we call it a <strong>prediction interval</strong></p>
<blockquote>
<p><font size="4"> Summary of the model in a plot </font></p>
</blockquote>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">ggplot</span>(midterm,<span class="kw">aes</span>(<span class="dt">x=</span>midterm,<span class="dt">y=</span>final))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm)<span class="op">+</span><span class="kw">stat_regline_equation</span>(<span class="kw">aes</span>(<span class="dt">label=</span><span class="kw">paste</span>(..eq.label.., ..rr.label..,<span class="dt">sep =</span> <span class="st">&quot;~~~~~~~&quot;</span>)),<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">geom =</span> <span class="st">&quot;label&quot;</span>)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Linear relationship between final exam scores and midterm exam scores&quot;</span>)</span></code></pre></div>
<p><img src="linearmodelling_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="multiple-linear-regression" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Multiple linear regression</h1>
<p>In <em>simple linear regression</em> we only consider one predictor variable. When we include more than one predictor variable, we have what is now a <strong>multiple linear regression model</strong>. Multiple linear regression allows us to investigate the joint effect of <strong>several predictors</strong> on the response variable.</p>
<p><strong>NB: as with simple linear regression we have one response variable.</strong></p>
<p>General form:</p>
<p><span class="math display">\[y=\beta_0+\beta_1x_1+......\beta_k xk+\epsilon\]</span> Where:</p>
<ul>
<li><span class="math inline">\(y\)</span>-response variable</li>
<li><span class="math inline">\(x_1,x_2.....x_k\)</span>-independent variables</li>
<li><span class="math inline">\(\beta_0\)</span>-constant/intercept</li>
<li><span class="math inline">\(\beta_1....\beta_k\)</span>-slope parameters</li>
<li><span class="math inline">\(\epsilon\)</span>-random variable/error</li>
</ul>
<div id="multiple-linear-problems" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Multiple linear problems</h2>
<p><font size="5"> Many universities in the US develop regression models for predicting GPA of incoming freshman. This estimated GPA can then be used to make admission decisions. Below are data for 15 students showing their GPA results(<span class="math inline">\(Y\)</span>); scores for two exams verbal(<span class="math inline">\(x_1\)</span>), mathematics(<span class="math inline">\(x_2\)</span>) and age of students (<span class="math inline">\(x_3\)</span>). </font></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>gpa&lt;-<span class="kw">read_csv</span>(<span class="st">&quot;GPA.csv&quot;</span>)</span></code></pre></div>
<pre><code>Parsed with column specification:
cols(
  y = col_double(),
  x1 = col_double(),
  x2 = col_double(),
  x3 = col_double()
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">GPA</th>
<th align="right">Verbal</th>
<th align="right">math</th>
<th align="right">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">3.49</td>
<td align="right">81</td>
<td align="right">87</td>
<td align="right">17.2</td>
</tr>
<tr class="even">
<td align="right">2.89</td>
<td align="right">68</td>
<td align="right">99</td>
<td align="right">18.0</td>
</tr>
<tr class="odd">
<td align="right">2.73</td>
<td align="right">57</td>
<td align="right">86</td>
<td align="right">17.0</td>
</tr>
<tr class="even">
<td align="right">1.54</td>
<td align="right">98</td>
<td align="right">49</td>
<td align="right">18.5</td>
</tr>
<tr class="odd">
<td align="right">2.56</td>
<td align="right">54</td>
<td align="right">83</td>
<td align="right">16.7</td>
</tr>
<tr class="even">
<td align="right">3.43</td>
<td align="right">82</td>
<td align="right">86</td>
<td align="right">17.3</td>
</tr>
<tr class="odd">
<td align="right">3.59</td>
<td align="right">75</td>
<td align="right">74</td>
<td align="right">19.1</td>
</tr>
<tr class="even">
<td align="right">2.86</td>
<td align="right">58</td>
<td align="right">98</td>
<td align="right">19.4</td>
</tr>
<tr class="odd">
<td align="right">1.49</td>
<td align="right">55</td>
<td align="right">54</td>
<td align="right">16.8</td>
</tr>
<tr class="even">
<td align="right">2.11</td>
<td align="right">49</td>
<td align="right">81</td>
<td align="right">18.0</td>
</tr>
<tr class="odd">
<td align="right">2.69</td>
<td align="right">64</td>
<td align="right">76</td>
<td align="right">18.6</td>
</tr>
<tr class="even">
<td align="right">3.51</td>
<td align="right">80</td>
<td align="right">86</td>
<td align="right">19.8</td>
</tr>
<tr class="odd">
<td align="right">2.99</td>
<td align="right">68</td>
<td align="right">84</td>
<td align="right">18.7</td>
</tr>
<tr class="even">
<td align="right">3.11</td>
<td align="right">74</td>
<td align="right">90</td>
<td align="right">17.4</td>
</tr>
<tr class="odd">
<td align="right">1.79</td>
<td align="right">59</td>
<td align="right">65</td>
<td align="right">18.2</td>
</tr>
</tbody>
</table>
<blockquote>
<p><font size="4"> State the estimated regression model. </font></p>
</blockquote>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>model&lt;-<span class="kw">lm</span>(GPA<span class="op">~</span>Verbal<span class="op">+</span>math<span class="op">+</span>age,<span class="dt">data =</span> gpa)</span>
<span id="cb20-2"><a href="#cb20-2"></a>model<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>(Intercept)      Verbal        math         age 
-2.70465476  0.02195390  0.03862480  0.04669531 </code></pre>
<p><span class="math display">\[GPA=-2.7047+0.02195verbal+0.0386math+0.0467age\]</span></p>
<blockquote>
<p><font size="4"> Is there a linear relationship between GPA and the examination scores and age? State the hypothesis and test statistic. </font></p>
</blockquote>
<p>The hypothesis to be tested is</p>
<p><span class="math inline">\(H_0\)</span>-<em>regression fit is not significant</em></p>
<p><span class="math inline">\(H_1\)</span>-<em>regression fit is significant</em></p>
<p>Using the f-statistic as the test statistic</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>sum_model=<span class="kw">summary</span>(model)</span>
<span id="cb22-2"><a href="#cb22-2"></a>sum_model<span class="op">$</span>fstatistic</span></code></pre></div>
<pre><code>    value     numdf     dendf 
 8.828339  3.000000 11.000000 </code></pre>
<p>The calculated F-statistic is 8.828. From the f-distribution table, the critical value is 4.07. Therefore the F-statistic is greater than the critical value. So we reject <span class="math inline">\(H_0\)</span> and conclude that there is a linear relationship between <code>GPA</code> ,the <code>verbal</code> and <code>math</code> score and <code>age</code> of a student.</p>
<blockquote>
<p><font size="4"> Interpret the regression co-efficients </font></p>
</blockquote>
<p><strong>Verbal</strong> - After adjusting for the <code>math</code> score and <code>age</code> of student, the average <code>GPA</code> increases by 0.021954 points for every additional point in the <code>verbal</code> score.</p>
<p><strong>math</strong> - After adjusting for the <code>verbal</code> score and <code>age</code> of student, the average <code>GPA</code> increases by 0.021954 points for every additional point in the <code>math</code> score.</p>
<p><strong>age</strong> - After adjusting for the <code>math</code> score and <code>verbal</code> score, the average <code>GPA</code> increases by 0.046695 points for every additional year in the <code>age</code> of a student</p>
<blockquote>
<p><font size="4"> Are both scores and age individually related to GPA? </font></p>
</blockquote>
<p>The hypothesis to be tested:</p>
<p><span class="math display">\[H_0:\beta_j=0\]</span></p>
<p><span class="math display">\[H_0:\beta_j\neq0\]</span> where <span class="math inline">\(j=1,2...n\)</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>sum_model<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>               Estimate  Std. Error    t value     Pr(&gt;|t|)
(Intercept) -2.70465476 2.193858648 -1.2328300 0.2433373351
Verbal       0.02195390 0.009025470  2.4324389 0.0332655987
math         0.03862480 0.008215196  4.7016284 0.0006484308
age          0.04669531 0.123893994  0.3768973 0.7134194757</code></pre>
<p>From the summary above.</p>
<p><strong>verbal</strong> The p-value is less than 0.05. therefore we reject <span class="math inline">\(H_0\)</span> and conclude that <code>verbal</code> score is a significant predictor for <code>GPA</code>.</p>
<p><strong>math</strong> .The p-value is less than 0.05. Therefore we reject <span class="math inline">\(H_0\)</span> and conclude that verbal score is a significant predictor for <code>GPA</code>.</p>
<p><strong>age</strong> The p-value is more than 0.05. Therefore we fail to reject <span class="math inline">\(H_0\)</span> and and conclude that <code>age</code> is <strong>not</strong> a significant predictor for <code>GPA</code>.</p>
<blockquote>
<p><font size="4"> Calculate the co-efficient of multiple determination and interpret it </font></p>
</blockquote>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>sum_model<span class="op">$</span>adj.r.squared</span></code></pre></div>
<pre><code>[1] 0.6265174</code></pre>
<p>We see that co-efficient of multiple determination is 0.6265. Therefore 62.65% of the variation in the <code>GPA</code> score is explained by the set of predictor variables.</p>
<blockquote>
<p><font size="4"> Estimate the GPA of a 17.5 year student with a verbal score of 82 a mathematics score of 84. </font></p>
</blockquote>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">predict</span>(model,<span class="dt">newdata=</span><span class="kw">data.frame</span>(<span class="dt">Verbal=</span><span class="dv">82</span>,<span class="dt">math=</span><span class="dv">84</span>,<span class="dt">age=</span><span class="fl">17.5</span>))</span></code></pre></div>
<pre><code>       1 
3.157217 </code></pre>
<p>3.157217</p>
<blockquote>
<p><font size="4"> Summary of the model using a plot </font></p>
</blockquote>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">ggplot</span>(gpa,<span class="kw">aes</span>(<span class="dt">x=</span>Verbal,<span class="dt">y=</span>GPA))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)<span class="op">+</span><span class="kw">stat_regline_equation</span>(<span class="kw">aes</span>(<span class="dt">label=</span><span class="kw">paste</span>(..rr.label..)),<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">geom =</span> <span class="st">&quot;label&quot;</span>) <span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Linear relationship between GPA and verbal score&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="kw">ggplot</span>(gpa,<span class="kw">aes</span>(<span class="dt">x=</span>math,<span class="dt">y=</span>GPA))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">method =</span><span class="st">&quot;lm&quot;</span>)<span class="op">+</span><span class="kw">stat_regline_equation</span>(<span class="kw">aes</span>(<span class="dt">label=</span><span class="kw">paste</span>(..rr.label..)),<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">geom =</span> <span class="st">&quot;label&quot;</span>)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Linear relationship between GPA and math score&quot;</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="kw">ggplot</span>(gpa,<span class="kw">aes</span>(<span class="dt">x=</span>age,<span class="dt">y=</span>GPA))<span class="op">+</span><span class="kw">geom_point</span>()<span class="op">+</span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)<span class="op">+</span><span class="kw">stat_regline_equation</span>(<span class="kw">aes</span>(<span class="dt">label=</span><span class="kw">paste</span>(..rr.label..)),<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">geom =</span> <span class="st">&quot;label&quot;</span>)<span class="op">+</span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Linear relationship between GPA and age&quot;</span>) </span></code></pre></div>
<p><img src="linearmodelling_files/figure-html/unnamed-chunk-22-1.png" width="70%" /><img src="linearmodelling_files/figure-html/unnamed-chunk-22-2.png" width="70%" /><img src="linearmodelling_files/figure-html/unnamed-chunk-22-3.png" width="70%" /></p>
</div>
</div>
<div id="multiple-linear-regression-with-qualitative-and-quantitative-predictor-variables." class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Multiple linear regression with qualitative and quantitative predictor variables.</h1>
<p>Regression analysis usually treats the predictor variables as numerical values or quantitative variables. However in some cases one may want to include an <strong>attribute/categorical variable</strong> to explain a response variable.</p>
<p><strong>dummy variable/indicator variable-</strong> is a variable that takes on the value 0 or 1. It represents a categorical variable with two distinct categories/levels</p>
<p><strong>binary predictor</strong>-is a variable that takes on only two possible values. e.g <em>gender(male or female), treatment(yes or no), smoking(smoker or non smoker)</em></p>
<p>General form</p>
<p><span class="math display">\[y=\beta_0+\beta_1 x_1+\beta_2 x_2+\epsilon\]</span> Where:</p>
<ul>
<li><p><span class="math inline">\(y\)</span>=response variable</p></li>
<li><p><span class="math inline">\(\beta_0\)</span>=constant/ intercept</p></li>
<li><p><span class="math inline">\(x_1\)</span>=quantitative predictor variable</p></li>
<li><p><span class="math inline">\(x_2\)</span>=qualitative predictor variable</p></li>
<li><p><span class="math inline">\(\beta_1\)</span>=co-efficient</p></li>
<li><p><span class="math inline">\(\beta_2\)</span>=differential intercept coefficient; it measures the differential effect of the categorical variable i.e in general <span class="math inline">\(\beta_2\)</span> shows how much higher(lower) the mean response line is for the <span class="math inline">\(1^{st}\)</span> category compared to the line for the <span class="math inline">\(2^{nd}\)</span> category (base category) for any given value of the categorical variable.</p></li>
<li><p><span class="math inline">\(x_i2 =1\)</span> if the response is in the <span class="math inline">\(1^{st}\)</span> category</p></li>
<li><p><span class="math inline">\(x_i2=0\)</span> if the response is in the <span class="math inline">\(2^{nd}\)</span> category</p></li>
</ul>
<p>The average value of the response of individuals in the <span class="math inline">\(2^{nd}\)</span> category is:</p>
<p><span class="math inline">\(E[Y|X_1,X_2=0]=\beta_0+\beta_1 X_1\)</span> &lt;-**base/category inference</p>
<p>While the average value of the response of individuals in the <span class="math inline">\(1^{st}\)</span> category is:</p>
<p><span class="math inline">\(E[Y|X_1,X_2=1]=\beta_0+\beta_1 X_1+\beta_2\)</span></p>
<div id="multiple-linear-regression-with-one-dummyqualitative-and-one-quantitative-predictor-variable-problems" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> Multiple linear regression with one dummy/qualitative and one quantitative predictor variable problems</h2>
<p><font size="5"> An economist wanted to see the relationship between the speed with which a particular insurance innovation is adopted (<span class="math inline">\(y\)</span>) (measured in months) and the worth of the insurance firm (<span class="math inline">\(x_1\)</span>) (in million of dollars) as well as the type of firm (<span class="math inline">\(x_2\)</span>). He studied 6 mutual firms and 6 stock firms and information obtained is presented above </font></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>insurance&lt;-<span class="kw">read_csv</span>(<span class="st">&quot;insurance.csv&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">speed</th>
<th align="right">worth</th>
<th align="left">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">17</td>
<td align="right">151</td>
<td align="left">mutual</td>
</tr>
<tr class="even">
<td align="right">26</td>
<td align="right">92</td>
<td align="left">mutual</td>
</tr>
<tr class="odd">
<td align="right">21</td>
<td align="right">175</td>
<td align="left">mutual</td>
</tr>
<tr class="even">
<td align="right">22</td>
<td align="right">104</td>
<td align="left">mutual</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">210</td>
<td align="left">mutual</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">290</td>
<td align="left">mutual</td>
</tr>
<tr class="odd">
<td align="right">28</td>
<td align="right">164</td>
<td align="left">stock</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">272</td>
<td align="left">stock</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">295</td>
<td align="left">stock</td>
</tr>
<tr class="even">
<td align="right">31</td>
<td align="right">85</td>
<td align="left">stock</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">166</td>
<td align="left">stock</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">124</td>
<td align="left">stock</td>
</tr>
</tbody>
</table>
<p>We assign a dummy variable to the type of firm. 1 if it is mutual, 0 if it is stock. This will help impprove model accuracy.</p>
<blockquote>
<p><font size="4"> Fit the regression coefficients </font></p>
</blockquote>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>model&lt;-<span class="kw">lm</span>(speed<span class="op">~</span>worth<span class="op">+</span>Type,<span class="dt">data =</span> insurance)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>model<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>(Intercept)       worth        Type 
40.82316274 -0.09940233 -6.89163261 </code></pre>
<p>The fit of the model is thus <span class="math inline">\(\widehat {speed\ of\ adoption} =40.823-0.0994worth\ of\ firm-6.892 type\ of\ firm\)</span></p>
<blockquote>
<p><font size="4"> Interpret the regression coefficients </font></p>
</blockquote>
<p>While holding <code>type of firm</code> constant, for every additional $1 million in <code>worth of firm</code>, the time a firm takes to adopt an insurance innovation reduces by 0.1 months. Also while holding the <code>worth of firm</code> constant, the time mutual firm to adopt an innovation is on average 6.98 months shorter than the time taken by the <code>stocks firms</code>.</p>
<blockquote>
<p><font size="4"> Test for the significance fit </font></p>
</blockquote>
<p>The hypothesis to be tested is</p>
<p><span class="math inline">\(H_o\)</span>: regression is not significant</p>
<p><span class="math inline">\(H_1\)</span>: regression is significant</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>sum_model=<span class="kw">summary</span>(model)</span>
<span id="cb35-2"><a href="#cb35-2"></a>sum_model<span class="op">$</span>fstatistic</span></code></pre></div>
<pre><code>   value    numdf    dendf 
46.84907  2.00000  9.00000 </code></pre>
<p>From the summary the f statistic is 46.85. From the f-distribution table the critical value is <span class="math inline">\(4.26\)</span>. The f-statistic is greater than the critical value. ,Therefore we reject <span class="math inline">\(H_0\)</span> and conclude that the regression fit is indeed significant.</p>
<blockquote>
<p><font size="4"> Are the predictors individually associated with the response. </font></p>
</blockquote>
<p>The hypothesis to be tested</p>
<p><span class="math display">\[H_0:\beta_j=0\]</span></p>
<p><span class="math display">\[H_1:\beta_j \neq0\]</span> where <span class="math inline">\(j=1,2...n\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>sum_model<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>               Estimate Std. Error   t value         Pr(&gt;|t|)
(Intercept) 40.82316274 2.31438063 17.638915 0.00000002741261
worth       -0.09940233 0.01101488 -9.024367 0.00000835123047
Type        -6.89163261 1.57840681 -4.366195 0.00180707598422</code></pre>
<p><strong>worth</strong>- The p-value is less that 0.05, therefore we reject <span class="math inline">\(H_0\)</span> and conclude that the <code>worth of a firm</code> is individually associated with the the <code>speed</code> with which a particular insurance innovation is adopted.</p>
<p><strong>Type of firm</strong> - The p-value is less than 0.05, therefore we reject <span class="math inline">\(H_0\)</span> and conclude that the <code>type of firm</code> is individually associated with the <code>speed</code> with which a particular insurance innovation is adopted.</p>
<blockquote>
<p><font size="4"> Estimate the time that lapses before a mutual firm worth $173 million adopts on insurance innovation.</font></p>
</blockquote>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">predict</span>(model,<span class="dt">newdata =</span> <span class="kw">data.frame</span>(<span class="dt">worth=</span><span class="dv">173</span>,<span class="dt">Type=</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>       1 
16.73493 </code></pre>
<p>we get <span class="math inline">\(16.73 \sim 17\)</span>months</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
